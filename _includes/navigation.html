<!-- Navigation -->
<nav class="bg-black py-2 sticky top-0 z-50">
  <div class="container mx-auto flex flex-wrap justify-center items-center gap-4">
    
    <!-- Nav Links -->
    <div class="flex flex-wrap justify-center gap-7 text-sm font-normal text-white">
      <a href="{{ '/' | relative_url }}" class="hover:text-white">Home</a>
      <a href="{{ '/ka1s' | relative_url }}" class="hover:text-white">KommuAssist</a>
      <a href="{{ '/store' | relative_url }}" class="hover:text-white">Store</a>
      <a href="{{ '/support' | relative_url }}" class="hover:text-white">Supported Cars</a>
      <a href="{{ '/kommunity' | relative_url }}" class="hover:text-white">Kommunity</a>
    </div>

    <!-- Right Side (Cart + Locale) -->
    <div class="flex items-center gap-4">
      <!-- Cart Icon -->
      <button onclick="toggleCart()" class="relative text-white text-lg">
        ðŸ›’
        <span id="cartCount" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">0</span>
      </button>

      <!-- Locale Selector -->
      <select id="localeSelector" class="bg-black text-white border border-white px-2 py-1 text-sm rounded">
        <option value="en-MY">ðŸ‡²ðŸ‡¾ MYR</option>
        <option value="en-US">ðŸ‡ºðŸ‡¸ USD</option>
      </select>
    </div>
  </div>
</nav>

<script>
  const localeSelector = document.getElementById("localeSelector");
  if (localeSelector) {
    const saved = localStorage.getItem("preferredLocale") || navigator.language || "en-US";
    localeSelector.value = saved;
    localeSelector.addEventListener("change", (e) => {
      localStorage.setItem("preferredLocale", e.target.value);
      location.reload(); // Or manually trigger UI update
    });
  }
function getCurrencyCode(locale) {
  const country = locale.split("-")[1] || "US";
  const currencyMap = {
    MY: "MYR", US: "USD", SG: "SGD", JP: "JPY", GB: "GBP"
  };
  return currencyMap[country] || "USD";
}

function getFormatter(locale) {
  const currency = getCurrencyCode(locale);
  return new Intl.NumberFormat(locale, {
    style: "currency",
    currency,
    minimumFractionDigits: 2
  });
}

function formatPrice(prices) {
  const locale = localStorage.getItem("preferredLocale") || navigator.language || "en-US";
  const currency = getCurrencyCode(locale);
  const formatter = getFormatter(locale);
  const price = prices[currency] || prices["USD"] || 0;
  return formatter.format(price);
}

</script>
