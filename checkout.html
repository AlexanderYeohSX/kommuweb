---
layout: default
title: Checkout
---
<!-- Checkout Page Layout -->
<div class="max-w-6xl mx-auto px-4 py-12">
  <!-- Checkout Title -->
  <div class="text-left mb-10">
    <h1 class="text-4xl font-bold mb-2 text-white">Checkout</h1>
  </div>

  <!-- Form and Cart Summary Layout -->
  <div id="checkoutGrid" class="grid md:grid-cols-2 gap-8">
    <!-- Left Form Fields -->
    <div class="text-white space-y-6">
      <div>
        <label class="block text-sm font-semibold mb-1">First Name</label>
        <input type="text" class="w-full bg-gray-900 border border-gray-700 px-4 py-3 rounded" placeholder="Your name">
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Email</label>
        <input type="email" class="w-full bg-gray-900 border border-gray-700 px-4 py-3 rounded" placeholder="you@email.com">
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Contact number</label>
        <input type="text" class="w-full bg-gray-900 border border-gray-700 px-4 py-3 rounded" placeholder="+60...">
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Street Address</label>
        <input type="text" class="w-full bg-gray-900 border border-gray-700 px-4 py-3 rounded" placeholder="Street, City, State, etc">
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Postcode</label>
        <input type="text" class="w-full bg-gray-900 border border-gray-700 px-4 py-3 rounded" placeholder="Postal code">
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Country</label>
        <input type="text" class="w-full bg-gray-900 border border-gray-700 px-4 py-3 rounded" placeholder="Country">
      </div>

      <!-- Product Selection Summary if fromProductPage -->
      <div id="productSummary" class="hidden bg-gray-800 p-4 rounded">
        <h3 class="text-lg font-semibold mb-2">Your Selection</h3>
        <ul class="text-sm space-y-1 text-gray-300" id="productSummaryList"></ul>
      </div>
    </div>

    <!-- Right Cart Summary -->
    <div id="checkoutCartSection" class="text-white">
      <h2 class="text-lg font-semibold mb-4 text-white">Your Cart</h2>
      <div id="checkoutCartItems" class="space-y-4 mb-6"></div>
      <div class="text-sm text-right">
        <p class="mb-1">Subtotal <span id="checkoutCartSubtotal" class="font-semibold ml-2">RM0</span></p>
        <p class="text-xs text-gray-400">Customs duties and import taxes for international orders are not included and may be charged separately by your local authorities.</p>
      </div>
    </div>
  </div>

  <!-- Summary Footer -->
  <div class="mt-12 bg-gray-900 p-6 rounded-lg text-white grid md:grid-cols-3 gap-6 items-center">
    <div>
      <p class="text-sm font-semibold">Welcome to Kommunity.</p>
      <p class="text-sm text-gray-400">Cruise with intelligence.</p>
    </div>
    <div class="text-sm">
      <p><strong>Shipping</strong></p>
      <p class="text-gray-400">Local Shipping – RM10<br>International Shipping – Thailand RM395</p>
    </div>
    <div class="text-sm text-right">
      <p class="mb-1"><strong>Total Due</strong></p>
      <p id="totalDue">RM0</p>
      <button class="mt-3 w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded shadow">Continue to Payment</button>
    </div>
  </div>
</div>

<script>
  const cartItems = JSON.parse(localStorage.getItem("cart")) || [];
  const formSelections = JSON.parse(localStorage.getItem("productSelections")) || {};
  let subtotal = 0;

  const cartSection = document.getElementById("checkoutCartSection");
  const formGrid = document.getElementById("checkoutGrid");
  const cartContainer = document.getElementById("checkoutCartItems");
  const subtotalDisplay = document.getElementById("checkoutCartSubtotal");
  const totalDueDisplay = document.getElementById("totalDue");

  const isFromProduct = localStorage.getItem("fromProductPage") === "true";
  if (isFromProduct) {
    cartSection.style.display = "none";
    formGrid.classList.remove("md:grid-cols-2");
    document.getElementById("productSummary").classList.remove("hidden");

    const list = document.getElementById("productSummaryList");
    const summaryFields = ["productName", "paymentPlan", "connectivity", "tradeIn", "installation"];
    summaryFields.forEach(key => {
      if (formSelections[key]) {
        const li = document.createElement("li");
        li.innerText = `${key.charAt(0).toUpperCase() + key.slice(1)}: ${formSelections[key]}`;
        list.appendChild(li);
      }
    });

    localStorage.removeItem("fromProductPage");
  }

  cartItems.forEach(item => {
    const locale = localStorage.getItem("preferredLocale") || navigator.language || "en-US";
    const currency = getCurrencyCode(locale);
    const formatter = getFormatter(locale);
    const priceValue = item.prices?.[currency] || item.prices?.USD || 0;

    const card = document.createElement("div");
    card.className = "bg-gray-800 flex justify-between items-center px-4 py-3 rounded";

    const details = document.createElement("div");
    details.className = "text-left";
    const title = document.createElement("p");
    title.className = "text-sm font-semibold";
    title.innerText = item.name;
    const desc = document.createElement("p");
    desc.className = "text-xs text-gray-400";
    desc.innerText = item.desc || "";
    const price = document.createElement("p");
    price.className = "text-sm font-medium";
    price.innerText = formatter.format(priceValue);

    details.appendChild(title);
    details.appendChild(desc);

    card.appendChild(details);
    card.appendChild(price);
    cartContainer.appendChild(card);

    subtotal += priceValue;
  });

  const locale = localStorage.getItem("preferredLocale") || navigator.language || "en-US";
  const formatter = getFormatter(locale);
  subtotalDisplay.innerText = formatter.format(subtotal);
  totalDueDisplay.innerText = formatter.format(subtotal + 10);
</script>
